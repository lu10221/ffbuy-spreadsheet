<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CONFIGç³»ç»Ÿæµ‹è¯• - $FFBuy SpreadSheet</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-section {
            background: white;
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-title {
            color: #333;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
            margin-bottom: 15px;
        }
        .test-result {
            background: #f8f9fa;
            padding: 10px;
            border-left: 4px solid #28a745;
            margin: 10px 0;
            font-family: monospace;
        }
        .error {
            border-left-color: #dc3545;
            background: #f8d7da;
        }
        .api-url {
            background: #e3f2fd;
            padding: 8px;
            border-radius: 4px;
            font-family: monospace;
            word-break: break-all;
        }
        .category-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 10px;
            margin: 10px 0;
        }
        .category-item {
            background: #f0f8ff;
            padding: 10px;
            border-radius: 4px;
            border: 1px solid #cce7ff;
        }
        .button {
            background: #007bff;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .button:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <h1>CONFIGç³»ç»Ÿå…¨é¢æµ‹è¯•</h1>
    <p>è¿™ä¸ªé¡µé¢å±•ç¤ºäº†å¦‚ä½•é€šè¿‡ä¿®æ”¹ <code>config.js</code> æ¥æ§åˆ¶æ•´ä¸ªç½‘ç«™çš„APIè°ƒç”¨å’Œåˆ†ç±»é…ç½®ã€‚</p>

    <div class="test-section">
        <h2 class="test-title">1. CONFIGå¯¹è±¡åŠ è½½æµ‹è¯•</h2>
        <div id="config-test"></div>
    </div>

    <div class="test-section">
        <h2 class="test-title">2. API URLç”Ÿæˆæµ‹è¯•</h2>
        <div id="api-test"></div>
        <button class="button" onclick="testApiUrls()">æµ‹è¯•API URLç”Ÿæˆ</button>
    </div>

    <div class="test-section">
        <h2 class="test-title">3. åˆ†ç±»é…ç½®æµ‹è¯•</h2>
        <div id="category-test"></div>
        <button class="button" onclick="testCategories()">æµ‹è¯•åˆ†ç±»é…ç½®</button>
    </div>

    <div class="test-section">
        <h2 class="test-title">4. å®é™…APIè°ƒç”¨æµ‹è¯•</h2>
        <div id="api-call-test"></div>
        <button class="button" onclick="testApiCall()">æµ‹è¯•APIè°ƒç”¨</button>
    </div>

    <div class="test-section">
        <h2 class="test-title">5. é…ç½®ä¿®æ”¹æ¼”ç¤º</h2>
        <p>è¦ä¿®æ”¹APIåœ°å€æˆ–åˆ†ç±»ï¼Œåªéœ€è¦ç¼–è¾‘ <code>config.js</code> æ–‡ä»¶ï¼š</p>
        <div class="test-result">
            <strong>ä¿®æ”¹APIåœ°å€ï¼š</strong><br>
            CONFIG.API.BASE_URL = 'https://new-api-url.com/spreadsheet-id'
        </div>
        <div class="test-result">
            <strong>æ·»åŠ æ–°åˆ†ç±»ï¼š</strong><br>
            CONFIG.categories.push({<br>
            &nbsp;&nbsp;name: 'NewCategory',<br>
            &nbsp;&nbsp;endpoint: 'NewCategory',<br>
            &nbsp;&nbsp;icon: 'fas fa-star',<br>
            &nbsp;&nbsp;fileName: 'NewCategory.html',<br>
            &nbsp;&nbsp;displayName: 'New Category'<br>
            })
        </div>
    </div>

    <script src="config.js"></script>
    <script src="product-service.js"></script>
    <script>
        // æµ‹è¯•CONFIGå¯¹è±¡åŠ è½½
        function testConfigLoading() {
            const configDiv = document.getElementById('config-test');
            
            if (typeof CONFIG === 'undefined') {
                configDiv.innerHTML = '<div class="test-result error">âŒ CONFIGå¯¹è±¡æœªåŠ è½½</div>';
                return;
            }
            
            let html = '<div class="test-result">âœ… CONFIGå¯¹è±¡å·²æˆåŠŸåŠ è½½</div>';
            html += `<div class="test-result">ç«™ç‚¹åç§°: ${CONFIG.SITE.NAME}</div>`;
            html += `<div class="test-result">APIåŸºç¡€URL: <div class="api-url">${CONFIG.API.BASE_URL}</div></div>`;
            html += `<div class="test-result">é»˜è®¤åˆ†ç±»: ${CONFIG.SITE.DEFAULT_CATEGORY}</div>`;
            html += `<div class="test-result">åˆ†ç±»æ€»æ•°: ${CONFIG.categories.length}</div>`;
            
            configDiv.innerHTML = html;
        }
        
        // æµ‹è¯•API URLç”Ÿæˆ
        function testApiUrls() {
            const apiDiv = document.getElementById('api-test');
            
            if (!CONFIG.UTILS || !CONFIG.UTILS.getCategoryUrl) {
                apiDiv.innerHTML = '<div class="test-result error">âŒ CONFIG.UTILS.getCategoryUrl ä¸å¯ç”¨</div>';
                return;
            }
            
            let html = '<div class="test-result">âœ… API URLç”ŸæˆåŠŸèƒ½æ­£å¸¸</div>';
            
            // æµ‹è¯•å‡ ä¸ªåˆ†ç±»çš„URLç”Ÿæˆ
            const testEndpoints = ['HOTPRODUCTS', 'T-Shirt', 'Hoodie Sweatshirt', 'Shoes'];
            
            testEndpoints.forEach(endpoint => {
                const url = CONFIG.UTILS.getCategoryUrl(endpoint);
                html += `<div class="test-result">${endpoint}: <div class="api-url">${url}</div></div>`;
            });
            
            apiDiv.innerHTML = html;
        }
        
        // æµ‹è¯•åˆ†ç±»é…ç½®
        function testCategories() {
            const categoryDiv = document.getElementById('category-test');
            
            if (!CONFIG.categories || CONFIG.categories.length === 0) {
                categoryDiv.innerHTML = '<div class="test-result error">âŒ åˆ†ç±»é…ç½®ä¸å¯ç”¨</div>';
                return;
            }
            
            let html = '<div class="test-result">âœ… åˆ†ç±»é…ç½®æ­£å¸¸</div>';
            html += '<div class="category-list">';
            
            CONFIG.categories.forEach(category => {
                html += `
                    <div class="category-item">
                        <strong>${category.displayName}</strong><br>
                        æ–‡ä»¶: ${category.fileName}<br>
                        ç«¯ç‚¹: ${category.endpoint}<br>
                        å›¾æ ‡: <i class="${category.icon}"></i>
                    </div>
                `;
            });
            
            html += '</div>';
            
            // æµ‹è¯•å·¥å…·å‡½æ•°
            const testCategory = CONFIG.UTILS.getCategoryByName('Shoes');
            if (testCategory) {
                html += `<div class="test-result">âœ… getCategoryByName('Shoes'): ${testCategory.displayName}</div>`;
            }
            
            const testByFile = CONFIG.UTILS.getCategoryByFileName('T-Shirt.html');
            if (testByFile) {
                html += `<div class="test-result">âœ… getCategoryByFileName('T-Shirt.html'): ${testByFile.displayName}</div>`;
            }
            
            categoryDiv.innerHTML = html;
        }
        
        // æµ‹è¯•å®é™…APIè°ƒç”¨
        async function testApiCall() {
            const apiCallDiv = document.getElementById('api-call-test');
            apiCallDiv.innerHTML = '<div class="test-result">ğŸ”„ æ­£åœ¨æµ‹è¯•APIè°ƒç”¨...</div>';
            
            try {
                if (!productService) {
                    throw new Error('productService ä¸å¯ç”¨');
                }
                
                // æµ‹è¯•è·å–HOTPRODUCTSæ•°æ®
                const products = await productService.fetchProducts('HOTPRODUCTS');
                
                let html = '<div class="test-result">âœ… APIè°ƒç”¨æˆåŠŸ</div>';
                html += `<div class="test-result">è·å–åˆ° ${products.length} ä¸ªäº§å“</div>`;
                
                if (products.length > 0) {
                    const firstProduct = products[0];
                    html += `<div class="test-result">ç¤ºä¾‹äº§å“: ${firstProduct.spbt || 'æ— æ ‡é¢˜'}</div>`;
                }
                
                apiCallDiv.innerHTML = html;
                
            } catch (error) {
                apiCallDiv.innerHTML = `<div class="test-result error">âŒ APIè°ƒç”¨å¤±è´¥: ${error.message}</div>`;
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¿è¡ŒåŸºç¡€æµ‹è¯•
        document.addEventListener('DOMContentLoaded', function() {
            testConfigLoading();
        });
    </script>
    
    <!-- å¼•å…¥Font Awesomeç”¨äºå›¾æ ‡æ˜¾ç¤º -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
</body>
</html>