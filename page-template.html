<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DZ3110PTYG"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-DZ3110PTYG');

        // ğŸ”½ è‡ªåŠ¨è·å–å¹¶ä¸ŠæŠ¥ utm_content å‚æ•°
        const urlParams = new URLSearchParams(window.location.search);
        const utmContent = urlParams.get('utm_content');
        if (utmContent) {
            gtag('event', 'utm_content_event', {
                utm_content: utmContent
            });
        }
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Category Name - $FFBuy SpreadSheet</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="stylesheet" href="global-search.css">    
    <link rel="stylesheet" href="product-detail-modal.css">
    
    <!-- ğŸ”¥ æ ¸å¿ƒé…ç½®æ–‡ä»¶ - å¿…é¡»æœ€å…ˆåŠ è½½ -->
    <script src="config.js"></script>
    
    <!-- ğŸ”¥ å¯¼èˆªç”Ÿæˆå™¨ - åŸºäºé…ç½®è‡ªåŠ¨ç”Ÿæˆå¯¼èˆª -->
    <script src="navigation-generator.js"></script>
    
    <!-- å…¶ä»–åŠŸèƒ½æ¨¡å— -->
    <script src="product-service.js"></script>
    <script src="product-renderer.js"></script>
    <script src="trust-info.js"></script>
    <script src="product-trust-info.js"></script>
    <script src="product-detail.js"></script>
</head>
<body>
    <!-- ğŸ”¥ ä¿¡ä»»ä¿¡æ¯æ  - å°†ç”±navigation-generator.jsè‡ªåŠ¨ç”Ÿæˆå’Œæ›´æ–° -->
    <div class="top-info-bar"> 
        <i class="fas fa-shield-alt"></i> 
        Loading...
    </div>
    
    <!-- ğŸ”¥ å›ºå®šLogoæ  - å°†ç”±navigation-generator.jsè‡ªåŠ¨æ›´æ–° -->
    <div class="fixed-logo-bar">
        <a href="index.html" class="logo">$FFBuy SpreadSheet</a>
    </div>
    
    <header>
        <div class="header-top">
            <a href="index.html" class="logo">$FFBuy SpreadSheet</a>
            <div class="nav-links">
                <!-- ğŸ”¥ å¯¼èˆªé“¾æ¥ - å°†ç”±navigation-generator.jsè‡ªåŠ¨ç”Ÿæˆ -->
                <a href="#">Loading...</a>
            </div>
        </div>
        <div class="header-bottom">
            <div class="search-container">
                <input type="text" class="search-box" placeholder="Search products...">
                <span class="search-icon"><i class="fas fa-search"></i></span>
            </div>
        </div>
    </header>

    <!-- ğŸ”¥ æ”¯ä»˜æ–¹å¼ä¿¡æ¯ - å°†ç”±navigation-generator.jsè‡ªåŠ¨ç”Ÿæˆ -->
    <div style="text-align: center; margin: 12px 0 18px;">
        <div style="font-size: 13px; color: #555; margin-bottom: 6px;">Loading...</div>
        <div style="display: inline-flex; align-items: center; gap: 12px;">
            Loading...
        </div>
    </div>

    <nav>
        <!-- ğŸ”¥ ä¸»å¯¼èˆª - å°†ç”±navigation-generator.jsè‡ªåŠ¨ç”Ÿæˆ -->
        <a href="#">Loading...</a>
    </nav>

    <main>
        <div id="products-container" class="products-grid">
            <!-- äº§å“å°†åœ¨è¿™é‡ŒåŠ¨æ€åŠ è½½ -->
        </div>
    </main>

    <!-- æµ®åŠ¨æŒ‰é’® -->
    <div id="floating-buttons-container"></div>
    
    <!-- äº§å“è¯¦æƒ…æ¨¡æ€æ¡† -->
    <div id="product-detail-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="modal-product-content"></div>
        </div>
    </div>

    <script>
        // ğŸ”¥ é¡µé¢ç‰¹å®šçš„äº§å“åŠ è½½é€»è¾‘
        async function fetchProducts() {
            try {
                // æ£€æŸ¥å¿…è¦çš„ä¾èµ–
                if (typeof productRenderer === 'undefined') {
                    console.error('productRenderer not loaded');
                    return;
                }
                
                // ğŸ”¥ ä½¿ç”¨å¯¼èˆªç”Ÿæˆå™¨è·å–å½“å‰åˆ†ç±»
                const currentCategory = navigationGenerator.getCurrentCategory();
                if (!currentCategory) {
                    console.error('Could not determine current category');
                    return;
                }
                
                // ğŸ”¥ åŠ è½½å½“å‰åˆ†ç±»çš„äº§å“æ•°æ®
                await productRenderer.loadProducts(currentCategory);
                
            } catch (error) {
                console.error('Error in fetchProducts:', error);
                const productsContainer = document.getElementById('products-container');
                if (productsContainer) {
                    productsContainer.innerHTML = `<div class="error-message">${error.message}</div>`;
                }
            }
        }

        // å½“é¡µé¢åŠ è½½å®Œæˆæ—¶ï¼Œè°ƒç”¨fetchProductså‡½æ•°è·å–äº§å“æ•°æ®
        document.addEventListener('DOMContentLoaded', function() {
            // ç­‰å¾…å¯¼èˆªç”Ÿæˆå™¨åˆå§‹åŒ–å®Œæˆåå†åŠ è½½äº§å“
            setTimeout(fetchProducts, 100);
        });
    </script>
    
    <!-- å…¶ä»–åŠŸèƒ½è„šæœ¬ -->
    <script src="category-navigation.js"></script>
    <script src="global-search.js"></script>
</body>
</html>